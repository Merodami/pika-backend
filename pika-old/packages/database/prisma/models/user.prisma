/// Users (customers and service providers)
model User {
  id                String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email             String            @unique
  emailVerified     Boolean           @default(false) @map("email_verified")
  password          String?
  firstName         String            @map("first_name") @db.VarChar(100)
  lastName          String            @map("last_name") @db.VarChar(100)
  phoneNumber       String?           @map("phone_number") @db.VarChar(50)
  phoneVerified     Boolean           @default(false) @map("phone_verified")
  avatarUrl         String?           @map("avatar_url") @db.VarChar(255)
  role              UserRole          @default(CUSTOMER)
  status            UserStatus        @default(ACTIVE)
  lastLoginAt       DateTime?         @map("last_login_at") @db.Timestamptz(6)
  createdAt         DateTime?         @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt         DateTime?         @default(now()) @map("updated_at") @db.Timestamptz(6) @updatedAt
  deletedAt         DateTime?         @map("deleted_at") @db.Timestamptz(6)

  // Relations
  customer          Customer?
  provider          Provider?
  reviews           Review[]          @relation("UserReviews")
  paymentMethods    PaymentMethod[]
  addresses         Address[]
  voucherRedemptions VoucherRedemption[]
  voucherScans      VoucherScan[]
  customerVouchers  CustomerVoucher[]
  
  // Fraud case relations
  fraudCasesAsCustomer FraudCase[]      @relation("FraudCaseCustomer")
  fraudCasesReviewed   FraudCase[]      @relation("FraudCaseReviewer")
  fraudCaseActions     FraudCaseHistory[]
  
  // Enhanced authentication relations
  identities        UserIdentity?
  authMethods       UserAuthMethod[]
  devices           UserDevice[]
  mfaSettings       UserMfaSettings?
  securityEvents    SecurityEvent[]
  
  // PDF book relations
  createdVoucherBooks VoucherBook[]   @relation("VoucherBookCreatedBy")

  @@index([email])
  @@index([phoneNumber])
  @@index([deletedAt])
  @@map("users")
  @@schema("users")
}