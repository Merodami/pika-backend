/// Business categories with industry-standard hierarchical structure
model Category {
  id              String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name            Json              // JSONB for multilingual names
  description     Json              // JSONB for multilingual descriptions
  iconUrl         String?           @map("icon_url") @db.VarChar(255)
  slug            String            @unique @db.VarChar(100)
  parentId        String?           @map("parent_id") @db.Uuid
  level           Int               @default(1) // 1 for root categories, 2+ for subcategories
  path            String            @default("") // Materialized path (e.g., "1.5.12")
  active          Boolean           @default(true)
  sortOrder       Int               @default(0) @map("sort_order")
  createdAt       DateTime?          @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime?          @default(now()) @map("updated_at") @db.Timestamptz(6) @updatedAt
  deletedAt         DateTime?         @map("deleted_at") @db.Timestamptz(6)

  // Self-relation for hierarchy (adjacency list pattern)
  parent          Category?         @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children        Category[]        @relation("CategoryHierarchy")
  
  // Other relations
  providers        Provider[]
  vouchers        Voucher[]

  @@index([slug])
  @@index([parentId])
  @@index([level])
  @@index([path])
  @@index([active, sortOrder])
  @@index([parentId, active])
  @@index([parentId, slug])
  @@map("categories")
  @@schema("marketplace")
}